---
layout: post
title: 记录下西安项目和最近调试DDR和PCIE遇到的坑。
date: 2018-8-30
author: 阿金
tags: 嵌入式 FPGA
---

## 西安项目调试的几个问题和解决方法

西安项目采用赛灵思 v7-690t-ffg-1761 芯片，作为主芯片，flash，DDR都不是采用的官方推荐做法。

### 未采用官方推荐的DDR配置

解决方法：VIVADO工程的MIG核因为层层封装，没有办法修改MIG的多个具体参数。只能采用ISE项目的方式将参数层层传输。ISE的MIG的IP核会生成许多源码。该源码可以在VIVADO下正常编译，并且系统正常启动；但是如果放在VIVADO的block design 编程范式里面，系统启动过后MIG没法正常初始化。不知道是什么问题。

### VIVADO crossbar IP错误

解决方式：这个问题很奇怪，VIVADO crossbar IP 连接多个主AXI设备，这些AXI设备不同时、不同通道、不同AW_ID。共同连接到同一个 MIG 从设备中。其他情况表现均正常，就是bvalid信号只会回复给第一个设备，即，第二个设备写AXI总线，第一个设备收到一个莫名其妙的bvalid，但是第二个设备一直收不到该valid。所以换成ISE的IP这个问题可以解决。

### Interconnect 复位

解决方式：Interconncet应该要比设备先启动，即，Interconnect 和AXI设备同时复位的情况下。Interconnet 先需要复位，进入工作状态，并且等待一段时间。之后AXI设备再开始启动，来读写Interconnect。

## 飞腾项目

主要是完成KU115上DDR与PCIE的测试。

项目地址位于

```HTTP
https://coding.net/u/yujincheng/p/ku115_pcie_ddr/
```
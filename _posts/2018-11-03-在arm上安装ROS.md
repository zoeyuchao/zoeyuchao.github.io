---
layout: post
title: ROS在ARM上的安装
date: 2018-11-03
author: 肇良
tags: 多机智能 嵌入式
---

# ROS在ARM上的安装
===============================

官网教程：
&emsp;&emsp;<font color = "66CCFF">http://wiki.ros.org/kinetic/Installation/Ubuntu</font>  

环境：  
树莓派3B+，Ubuntu16.04 LTS  

### 1.安装流程：  
* 1.1 设置软件仓库
这是镜像网站的指导，官网上的不太好使  
<font color = "66CCFF">http://wiki.ros.org/ROS/Installation/UbuntuMirrors</font>  
我选择的是清华的tuna镜像，输入  
&emsp;```$ sudo sh -c '. /etc/lsb-release && echo "deb http://mirrors.tuna.tsinghua.edu.cn/ros/ubuntu/ $DISTRIB_CODENAME main" > /etc/apt/sources.list.d/ros-latest.list```  

* 1.2 设置密钥  
&emsp;```$ sudo apt-key adv --keyserver hkp://ha.pool.sks-keyservers.net:80 --recv-key 421C365BD9FF1F717815A3895523BAEEB01FA116```  

* 1.3 安装  
先更新软件库
&emsp;```$ sudo apt update```  
树莓派上的Ubuntu没有图形界面，所以我们安装无GUI的基本版本  
&emsp;```$ sudo apt install ros-kinetic-ros-base```  

* 1.4 初始化rosdep  
&emsp;```$ sudo rosdep init```
&emsp;```$ rosdep update```  

* 1.5 路径设置  
&emsp;```$ echo "source /opt/ros/kinetic/setup.bash" >> ~/.bashrc```  
&emsp;```$ source .bashrc```  

* 1.6 安装依赖库  
&emsp;```$ sudo apt-get install python-rosinstall python-rosinstall-generator python-wstool build-essential```  

### 2.可能遇到的问题  
如果安装最新版的melodic，apt安装很有可能找不到软件包，可以尝试源码安装，但是源码安装也会碰到许多问题  

* 2.1  
	ERROR [vcstools] Tarball download unpack failed: file could not be opened successfully[/vcstools]
这个问题没有解决  

* 2.2  No module named terminal_color  
解决办法：  
&emsp;```$ sudo apt-get install python-pip```
&emsp;```$ sudo pip install –upgrade catkin_pkg_modules```  

* 2.3  编译到一半卡死  
原因是树莓派的内存不足，需要在储存卡上开辟swap交换空间作虚拟内存  
&emsp;```$ cd /opt```
&emsp;```$ sudo mkdir image```  
&emsp;```$ sudo touch swap```
&emsp;```$ sudo dd if=/dev/zero of=/opt/image/swap bs=1024 count=204800```  
过一段时间应该会显示  
2048000+0 records in  
2048000+0 records out  
2097152000 bytes (2.1 GB, 2.0 GiB) copied, 242.095 s, 8.7 MB/s  
使用下面命令启动新的交换空间  
&emsp;```$ sudo swapon /opt/image/swap```  
输入  
&emsp;```$ free -m```  
确认生效  

|  | total | used | free | shared | buffer/cache | available |
| - | :-: | -: | -: | -: | -: | -: |
| Mem: | ** | ** | ** | ** | ** | ** |
| Swap: | 1999 | 0 | 1999 |
修改文件  
&emsp;```$ sudo vim /etc/fstab```  
在后面加入 "/opt/image/swap&emsp;/swap&emsp;swap&emsp;defaults&emsp;0&emsp;0"  
重启系统即可